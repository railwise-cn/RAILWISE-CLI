/// <reference path="../env.d.ts" />
import { tool } from "nb-railwise/tool"

type Clause = {
  code: string
  title: string
  section: string
  content: string
  keywords: string[]
  mandatory: boolean
}

const STANDARDS: Clause[] = [
  // GB 50911 â€” åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ
  {
    code: "GB 50911",
    title: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ",
    section: "3.0.1",
    content: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹çš„è®¾è®¡ã€æ–½å·¥åŠè¿è¥é˜¶æ®µï¼Œåº”æ ¹æ®å·¥ç¨‹ç‰¹ç‚¹å’Œç¯å¢ƒæ¡ä»¶åˆ¶å®šç›‘æµ‹æ–¹æ¡ˆï¼Œè¿›è¡Œå·¥ç¨‹ç›‘æµ‹ã€‚",
    keywords: ["ç›‘æµ‹æ–¹æ¡ˆ", "è®¾è®¡é˜¶æ®µ", "æ–½å·¥é˜¶æ®µ", "è¿è¥é˜¶æ®µ"],
    mandatory: true,
  },
  {
    code: "GB 50911",
    title: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ",
    section: "3.0.3",
    content: "ç›‘æµ‹å·¥ä½œåº”åšåˆ°ï¼š1 é‡‡ç”¨çš„ç›‘æµ‹æ–¹æ³•å’Œç²¾åº¦åº”æ»¡è¶³ç›‘æµ‹è¦æ±‚ï¼›2 ç›‘æµ‹è¿‡ç¨‹ä¸­åº”åŠ å¼ºå¯¹ç›‘æµ‹ç‚¹çš„ä¿æŠ¤ï¼Œé¿å…æŸåï¼›3 ç›‘æµ‹æ•°æ®åº”åŠæ—¶å¤„ç†ã€åˆ†æå’Œåé¦ˆã€‚",
    keywords: ["ç›‘æµ‹ç²¾åº¦", "ç›‘æµ‹æ–¹æ³•", "æ•°æ®åé¦ˆ"],
    mandatory: true,
  },
  {
    code: "GB 50911",
    title: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ",
    section: "4.2.1",
    content: "åŸºå‡†ç‚¹åº”åŸ‹è®¾åœ¨å˜å½¢å½±å“èŒƒå›´ä»¥å¤–ç¨³å®šçš„åŒºåŸŸï¼Œä¸”ä¸å°‘äº3ä¸ªã€‚åŸºå‡†ç‚¹é—´è·ä¸å®œå¤§äº500mï¼Œå¹¶åº”å®šæœŸè¿›è¡Œç¨³å®šæ€§æ£€éªŒã€‚",
    keywords: ["åŸºå‡†ç‚¹", "ç¨³å®šæ€§", "å½±å“èŒƒå›´", "åŸ‹è®¾"],
    mandatory: false,
  },
  {
    code: "GB 50911",
    title: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ",
    section: "5.1.2",
    content: "åœ°é“ä¿æŠ¤åŒºç›‘æµ‹åº”åŒ…æ‹¬ï¼šç»“æ„æ²‰é™ã€ç»“æ„æ°´å¹³ä½ç§»ã€éš§é“æ”¶æ•›ã€åœ°è¡¨æ²‰é™ã€ç®¡çº¿ä½ç§»ã€å»ºç­‘ç‰©æ²‰é™ä¸å€¾æ–œç­‰é¡¹ç›®ï¼Œå¹¶åº”æ ¹æ®å·¥ç¨‹å½±å“ç­‰çº§ç¡®å®šå¿…æµ‹é¡¹å’Œé€‰æµ‹é¡¹ã€‚",
    keywords: ["ä¿æŠ¤åŒº", "ç»“æ„æ²‰é™", "æ°´å¹³ä½ç§»", "éš§é“æ”¶æ•›", "ç®¡çº¿", "å¿…æµ‹é¡¹"],
    mandatory: true,
  },
  {
    code: "GB 50911",
    title: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ",
    section: "5.4.1",
    content: "ç›‘æµ‹é¢‘ç‡åº”æ ¹æ®æ–½å·¥è¿›åº¦ã€å˜å½¢é€Ÿç‡å’Œå˜å½¢é‡å¤§å°ç»¼åˆç¡®å®šã€‚æ–½å·¥æœŸå…³é”®é˜¶æ®µç›‘æµ‹é¢‘ç‡ä¸åº”ä½äº1æ¬¡/å¤©ã€‚",
    keywords: ["ç›‘æµ‹é¢‘ç‡", "æ–½å·¥è¿›åº¦", "å˜å½¢é€Ÿç‡", "å…³é”®é˜¶æ®µ"],
    mandatory: true,
  },
  {
    code: "GB 50911",
    title: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ",
    section: "5.5.1",
    content: "ç›‘æµ‹æŠ¥è­¦å€¼åº”æ ¹æ®ç›¸å…³è®¾è®¡æ–‡ä»¶ã€è§„èŒƒè¦æ±‚å’Œå·¥ç¨‹ç»éªŒç»¼åˆç¡®å®šã€‚å½“ç›‘æµ‹å€¼è¾¾åˆ°æŠ¥è­¦å€¼æ—¶ï¼Œåº”åŠæ—¶æŠ¥å‘Šå»ºè®¾å•ä½å’Œç›¸å…³éƒ¨é—¨ï¼Œå¹¶åº”é‡‡å–ç›¸åº”æªæ–½ã€‚",
    keywords: ["æŠ¥è­¦å€¼", "æŠ¥è­¦", "é¢„è­¦", "æ§åˆ¶å€¼"],
    mandatory: true,
  },
  {
    code: "GB 50911",
    title: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ",
    section: "7.2.1",
    content: "ç«–å‘ä½ç§»ç›‘æµ‹ç²¾åº¦ç­‰çº§ä¸åº”ä½äºäºŒç­‰æ°´å‡†æµ‹é‡ï¼Œé«˜ç¨‹ä¸­è¯¯å·®ä¸åº”å¤§äºÂ±0.5mmã€‚å½“é‡‡ç”¨é™åŠ›æ°´å‡†æ—¶ï¼Œç³»ç»Ÿåˆ†è¾¨åŠ›ä¸åº”å¤§äº0.01mmã€‚",
    keywords: ["ç«–å‘ä½ç§»", "æ°´å‡†æµ‹é‡", "ç²¾åº¦", "é™åŠ›æ°´å‡†"],
    mandatory: false,
  },
  {
    code: "GB 50911",
    title: "åŸå¸‚è½¨é“äº¤é€šå·¥ç¨‹ç›‘æµ‹æŠ€æœ¯è§„èŒƒ",
    section: "7.3.1",
    content: "æ°´å¹³ä½ç§»ç›‘æµ‹å®œé‡‡ç”¨å…¨ç«™ä»ªæåæ ‡æ³•ã€è§†å‡†çº¿æ³•æˆ–è‡ªåŠ¨åŒ–ç›‘æµ‹ç³»ç»Ÿã€‚å…¨ç«™ä»ªæµ‹è§’ä¸­è¯¯å·®ä¸åº”å¤§äº1â€³ï¼Œæµ‹è·ä¸­è¯¯å·®ä¸åº”å¤§äº1mm+1ppmã€‚",
    keywords: ["æ°´å¹³ä½ç§»", "å…¨ç«™ä»ª", "æåæ ‡", "è§†å‡†çº¿"],
    mandatory: false,
  },

  // GB 50497 â€” å»ºç­‘åŸºå‘å·¥ç¨‹ç›‘æµ‹æŠ€æœ¯æ ‡å‡†
  {
    code: "GB 50497",
    title: "å»ºç­‘åŸºå‘å·¥ç¨‹ç›‘æµ‹æŠ€æœ¯æ ‡å‡†",
    section: "3.0.1",
    content: "å¼€æŒ–æ·±åº¦å¤§äºç­‰äº5mæˆ–å¼€æŒ–æ·±åº¦å°äº5mä½†ç°åœºåœ°è´¨æ¡ä»¶å’Œå‘¨å›´ç¯å¢ƒè¾ƒå¤æ‚çš„åŸºå‘å·¥ç¨‹ï¼Œåº”å®æ–½åŸºå‘å·¥ç¨‹ç›‘æµ‹ã€‚",
    keywords: ["åŸºå‘", "å¼€æŒ–æ·±åº¦", "5m", "ç›‘æµ‹"],
    mandatory: true,
  },
  {
    code: "GB 50497",
    title: "å»ºç­‘åŸºå‘å·¥ç¨‹ç›‘æµ‹æŠ€æœ¯æ ‡å‡†",
    section: "3.0.2",
    content: "åŸºå‘å·¥ç¨‹ç›‘æµ‹åº”åŒ…æ‹¬ä»¥ä¸‹å¿…æµ‹é¡¹ç›®ï¼š1 å›´æŠ¤å¢™ï¼ˆæ¡©ï¼‰é¡¶æ°´å¹³ä½ç§»ï¼›2 å‘¨è¾¹åœ°è¡¨æ²‰é™ï¼›3 å›´æŠ¤å¢™ï¼ˆæ¡©ï¼‰é¡¶ç«–å‘ä½ç§»ã€‚å®‰å…¨ç­‰çº§ä¸ºä¸€çº§çš„åŸºå‘è¿˜åº”åŒ…æ‹¬ï¼šæ·±å±‚æ°´å¹³ä½ç§»ã€æ”¯æ’‘è½´åŠ›ã€åœ°ä¸‹æ°´ä½ç­‰ã€‚",
    keywords: ["å¿…æµ‹é¡¹ç›®", "å›´æŠ¤å¢™", "æ°´å¹³ä½ç§»", "åœ°è¡¨æ²‰é™", "æ”¯æ’‘è½´åŠ›", "åœ°ä¸‹æ°´ä½"],
    mandatory: true,
  },
  {
    code: "GB 50497",
    title: "å»ºç­‘åŸºå‘å·¥ç¨‹ç›‘æµ‹æŠ€æœ¯æ ‡å‡†",
    section: "5.0.1",
    content: "å›´æŠ¤å¢™é¡¶æ°´å¹³ä½ç§»æŠ¥è­¦å€¼ï¼šä¸€çº§åŸºå‘ä¸åº”å¤§äº30mmï¼Œä¸”æ—¥å˜åŒ–é‡ä¸åº”å¤§äº3mm/dï¼›äºŒçº§åŸºå‘ä¸åº”å¤§äº40mmã€‚å›´æŠ¤å¢™æ·±å±‚æœ€å¤§æ°´å¹³ä½ç§»æŠ¥è­¦å€¼ï¼šä¸€çº§ä¸åº”å¤§äº0.3%Hï¼ˆHä¸ºåŸºå‘æ·±åº¦ï¼‰ï¼ŒäºŒçº§ä¸åº”å¤§äº0.6%Hã€‚",
    keywords: ["æŠ¥è­¦å€¼", "å›´æŠ¤å¢™", "æ°´å¹³ä½ç§»", "30mm", "æ—¥å˜åŒ–é‡", "3mm/d"],
    mandatory: true,
  },
  {
    code: "GB 50497",
    title: "å»ºç­‘åŸºå‘å·¥ç¨‹ç›‘æµ‹æŠ€æœ¯æ ‡å‡†",
    section: "5.0.3",
    content: "åœ°è¡¨æ²‰é™æŠ¥è­¦å€¼ï¼šä¸€çº§åŸºå‘çš„æœ€å¤§æ²‰é™é‡ä¸åº”å¤§äº0.15%Lï¼ˆLä¸ºåŸºå‘è¾¹é•¿ï¼‰ï¼Œä¸”æ—¥æ²‰é™é‡ä¸åº”å¤§äº2mm/dã€‚ç®¡çº¿å˜å½¢æŠ¥è­¦å€¼åº”æ ¹æ®ç®¡çº¿ç±»å‹å’Œæè´¨ç¡®å®šï¼Œåˆšæ€§ç®¡çº¿ä¸åº”å¤§äº10mmã€‚",
    keywords: ["åœ°è¡¨æ²‰é™", "ç®¡çº¿", "æŠ¥è­¦å€¼", "æ—¥æ²‰é™é‡"],
    mandatory: true,
  },
  {
    code: "GB 50497",
    title: "å»ºç­‘åŸºå‘å·¥ç¨‹ç›‘æµ‹æŠ€æœ¯æ ‡å‡†",
    section: "6.2.1",
    content: "åŸºå‘å·¥ç¨‹ç›‘æµ‹é¢‘ç‡åº”æ ¹æ®æ–½å·¥è¿›ç¨‹ç¡®å®šï¼šå¼€æŒ–æœŸé—´ä¸åº”å°‘äº1æ¬¡/å¤©ï¼›å½“å‡ºç°å¼‚å¸¸æƒ…å†µæˆ–è¾¾åˆ°æŠ¥è­¦å€¼æ—¶ï¼Œåº”åŠ å¯†ç›‘æµ‹å¹¶æŒç»­è‡³å˜å½¢è¶‹äºç¨³å®šã€‚åŸºå‘ä½¿ç”¨è¶…è¿‡è®¾è®¡å·¥å†µæ—¶é—´æ—¶ï¼Œç›‘æµ‹é¢‘ç‡ä¸åº”ä½äº1æ¬¡/å‘¨ã€‚",
    keywords: ["ç›‘æµ‹é¢‘ç‡", "å¼€æŒ–æœŸé—´", "1æ¬¡/å¤©", "åŠ å¯†ç›‘æµ‹"],
    mandatory: true,
  },
  {
    code: "GB 50497",
    title: "å»ºç­‘åŸºå‘å·¥ç¨‹ç›‘æµ‹æŠ€æœ¯æ ‡å‡†",
    section: "7.1.1",
    content: "ç›‘æµ‹ç‚¹å¸ƒç½®åº”æ»¡è¶³ç›‘æµ‹è¦æ±‚ï¼šå›´æŠ¤å¢™é¡¶æ°´å¹³ä½ç§»ç›‘æµ‹ç‚¹æ²¿åŸºå‘å‘¨è¾¹å¸ƒç½®ï¼Œé—´è·ä¸å®œå¤§äº20mï¼Œå…³é”®éƒ¨ä½åº”é€‚å½“åŠ å¯†ã€‚åœ°è¡¨æ²‰é™ç›‘æµ‹ç‚¹åº”åœ¨å¼€æŒ–å½±å“èŒƒå›´å†…æŒ‰æ–­é¢å¸ƒç½®ã€‚",
    keywords: ["ç›‘æµ‹ç‚¹å¸ƒç½®", "é—´è·", "20m", "æ–­é¢"],
    mandatory: false,
  },

  // JGJ 8 â€” å»ºç­‘å˜å½¢æµ‹é‡è§„èŒƒ
  {
    code: "JGJ 8",
    title: "å»ºç­‘å˜å½¢æµ‹é‡è§„èŒƒ",
    section: "3.0.2",
    content: "å˜å½¢æµ‹é‡ç­‰çº§åˆ’åˆ†ä¸ºå››ä¸ªç­‰çº§ã€‚ä¸€ç­‰é€‚ç”¨äºç‰¹åˆ«é‡è¦æˆ–ç‰¹åˆ«ç²¾å¯†çš„å·¥ç¨‹ï¼ŒäºŒç­‰é€‚ç”¨äºé‡è¦æˆ–ç²¾å¯†å·¥ç¨‹ï¼ˆå¦‚é«˜å±‚å»ºç­‘ã€åœ°é“ï¼‰ï¼Œä¸‰ç­‰é€‚ç”¨äºä¸€èˆ¬å·¥ç¨‹ï¼Œå››ç­‰é€‚ç”¨äºç²¾åº¦è¦æ±‚è¾ƒä½çš„å·¥ç¨‹ã€‚",
    keywords: ["å˜å½¢æµ‹é‡ç­‰çº§", "ä¸€ç­‰", "äºŒç­‰", "ä¸‰ç­‰", "å››ç­‰"],
    mandatory: false,
  },
  {
    code: "JGJ 8",
    title: "å»ºç­‘å˜å½¢æµ‹é‡è§„èŒƒ",
    section: "4.1.3",
    content: "æ²‰é™è§‚æµ‹çš„æ°´å‡†åŸºç‚¹åº”ä¸å°‘äº3ä¸ªï¼Œå¹¶åº”åŸ‹è®¾åœ¨å˜å½¢å½±å“åŒºåŸŸä»¥å¤–ã€‚åŸºå‡†ç‚¹ä¹‹é—´åº”ç»„æˆé—­åˆç¯è·¯æˆ–é™„åˆæ°´å‡†è·¯çº¿è¿›è¡Œè”æµ‹ã€‚",
    keywords: ["æ°´å‡†åŸºç‚¹", "åŸºå‡†ç‚¹", "é—­åˆç¯è·¯", "3ä¸ª"],
    mandatory: false,
  },
  {
    code: "JGJ 8",
    title: "å»ºç­‘å˜å½¢æµ‹é‡è§„èŒƒ",
    section: "4.3.1",
    content: "æ°´å‡†æµ‹é‡å„ç­‰çº§ç²¾åº¦è¦æ±‚ï¼šäºŒç­‰æ°´å‡†è§†çº¿é•¿åº¦ä¸å¤§äº50mï¼Œå‰åè§†è·å·®ä¸å¤§äº1mï¼Œæ¯ç«™é«˜å·®ä¸­è¯¯å·®ä¸å¤§äº0.5mmã€‚ä¸‰ç­‰æ°´å‡†è§†çº¿é•¿åº¦ä¸å¤§äº75mï¼Œå‰åè§†è·å·®ä¸å¤§äº3mã€‚",
    keywords: ["æ°´å‡†æµ‹é‡", "ç²¾åº¦", "è§†çº¿é•¿åº¦", "å‰åè§†è·å·®"],
    mandatory: false,
  },
  {
    code: "JGJ 8",
    title: "å»ºç­‘å˜å½¢æµ‹é‡è§„èŒƒ",
    section: "5.1.1",
    content: "å»ºç­‘æ²‰é™ç¨³å®šæ ‡å‡†ï¼šæœ€å100å¤©çš„æ²‰é™é€Ÿç‡å°äº0.01~0.04mm/dï¼ˆç”±åŸºç¡€ç±»å‹ç¡®å®šï¼‰ï¼Œå¯è®¤ä¸ºå·²è¿›å…¥ç¨³å®šé˜¶æ®µã€‚åœ°åŸºä¸ºç ‚ç±»åœŸæ—¶å–å°å€¼ï¼Œåœ°åŸºä¸ºæ·¤æ³¥è´¨é»åœŸæ—¶å–å¤§å€¼ã€‚",
    keywords: ["æ²‰é™ç¨³å®š", "æ²‰é™é€Ÿç‡", "0.01mm/d", "ç¨³å®šæ ‡å‡†"],
    mandatory: false,
  },
  {
    code: "JGJ 8",
    title: "å»ºç­‘å˜å½¢æµ‹é‡è§„èŒƒ",
    section: "5.5.1",
    content: "å»ºç­‘å€¾æ–œè§‚æµ‹åº”æµ‹å®šå»ºç­‘é¡¶éƒ¨ç›¸å¯¹äºåº•éƒ¨çš„æ°´å¹³ä½ç§»ã€‚å¤šå±‚å’Œé«˜å±‚å»ºç­‘çš„å€¾æ–œæŠ¥è­¦å€¼ä¸ºH/500ï¼ˆHä¸ºå»ºç­‘é«˜åº¦ï¼‰ï¼Œæ•´ä½“å€¾æ–œä¸åº”è¶…è¿‡H/250ã€‚",
    keywords: ["å€¾æ–œ", "å€¾æ–œæŠ¥è­¦å€¼", "H/500", "å»ºç­‘é«˜åº¦"],
    mandatory: false,
  },

  // GB 50026 â€” å·¥ç¨‹æµ‹é‡æ ‡å‡†
  {
    code: "GB 50026",
    title: "å·¥ç¨‹æµ‹é‡æ ‡å‡†",
    section: "4.2.1",
    content: "å¹³é¢æ§åˆ¶ç½‘çš„ç­‰çº§åˆ†ä¸ºä¸€ç­‰è‡³å››ç­‰ï¼Œä»¥åŠä¸€çº§è‡³ä¸‰çº§ã€‚åŸå¸‚æµ‹é‡ä¸€èˆ¬é‡‡ç”¨äºŒç­‰ä»¥ä¸Šæ§åˆ¶ç½‘ã€‚GPSæ§åˆ¶ç½‘çš„åŸºçº¿å‘é‡è§£ç®—åº”æ»¡è¶³ï¼šåŒæ­¥è§‚æµ‹æ—¶é—´ä¸å°‘äº60minï¼ˆé™æ€ï¼‰ï¼Œå•é¢‘æ¥æ”¶æœºåŸºçº¿é•¿åº¦ä¸å¤§äº15kmã€‚",
    keywords: ["æ§åˆ¶ç½‘", "ç­‰çº§", "GPS", "åŸºçº¿", "é™æ€è§‚æµ‹"],
    mandatory: false,
  },
  {
    code: "GB 50026",
    title: "å·¥ç¨‹æµ‹é‡æ ‡å‡†",
    section: "4.3.1",
    content: "é«˜ç¨‹æ§åˆ¶ç½‘ç­‰çº§ï¼šä¸€ç­‰æ°´å‡†é—­åˆå·®é™å·®Â±4âˆšL mmï¼ŒäºŒç­‰Â±6âˆšL mmï¼ˆåŸå¸‚è½¨é“äº¤é€šåŸºå‡†ç½‘å¸¸ç”¨ï¼‰ï¼Œä¸‰ç­‰Â±12âˆšL mmï¼Œå››ç­‰Â±20âˆšL mmï¼ˆLä¸ºè·¯çº¿é•¿åº¦/kmï¼‰ã€‚",
    keywords: ["é«˜ç¨‹æ§åˆ¶", "é—­åˆå·®", "é™å·®", "æ°´å‡†", "4âˆšL", "6âˆšL", "12âˆšL", "20âˆšL"],
    mandatory: true,
  },
  {
    code: "GB 50026",
    title: "å·¥ç¨‹æµ‹é‡æ ‡å‡†",
    section: "5.1.1",
    content: "å¯¼çº¿æµ‹é‡çš„è§’åº¦é—­åˆå·®é™å·®ï¼šDJ1ä»ªå™¨Â±5â€³âˆšnï¼ŒDJ2ä»ªå™¨Â±10â€³âˆšnï¼ŒDJ6ä»ªå™¨Â±20â€³âˆšnï¼ˆnä¸ºæµ‹ç«™æ•°ï¼‰ã€‚å…¨é•¿ç›¸å¯¹é—­åˆå·®ï¼šä¸€çº§å¯¼çº¿ä¸å¤§äº1/40000ï¼ŒäºŒçº§ä¸å¤§äº1/20000ï¼Œä¸‰çº§ä¸å¤§äº1/10000ã€‚",
    keywords: ["å¯¼çº¿", "è§’åº¦é—­åˆå·®", "DJ1", "DJ2", "DJ6", "ç›¸å¯¹é—­åˆå·®"],
    mandatory: true,
  },
  {
    code: "GB 50026",
    title: "å·¥ç¨‹æµ‹é‡æ ‡å‡†",
    section: "6.2.1",
    content: "åœ°å½¢æµ‹é‡çš„é«˜ç¨‹æ³¨è®°åº”å–ä½è‡³0.01mã€‚å»ºç­‘ç‰©è½®å»“ç‚¹ä½ä¸­è¯¯å·®ä¸åº”å¤§äºå›¾ä¸Š0.5mmï¼Œç‹¬ç«‹åœ°ç‰©ç‚¹ä½ä¸­è¯¯å·®ä¸åº”å¤§äºå›¾ä¸Š1.0mmã€‚",
    keywords: ["åœ°å½¢æµ‹é‡", "é«˜ç¨‹æ³¨è®°", "ç‚¹ä½ä¸­è¯¯å·®"],
    mandatory: false,
  },
]

function score(clause: Clause, keywords: string[]) {
  const lower = keywords.map(k => k.toLowerCase())
  let s = 0
  for (const kw of clause.keywords) {
    if (lower.some(q => kw.toLowerCase().includes(q) || q.includes(kw.toLowerCase()))) s += 2
  }
  if (lower.some(q => clause.content.toLowerCase().includes(q))) s += 1
  if (lower.some(q => clause.section.includes(q))) s += 3
  if (lower.some(q => clause.code.toLowerCase().includes(q.toLowerCase()))) s += 2
  return s
}

export const query_standard = tool({
  description:
    "æŸ¥è¯¢å·¥ç¨‹ç›‘æµ‹ç›¸å…³è§„èŒƒæ¡æ–‡ã€‚å†…ç½® GB 50911ï¼ˆè½¨é“äº¤é€šç›‘æµ‹ï¼‰ã€GB 50497ï¼ˆåŸºå‘ç›‘æµ‹ï¼‰ã€JGJ 8ï¼ˆå˜å½¢æµ‹é‡ï¼‰ã€GB 50026ï¼ˆå·¥ç¨‹æµ‹é‡ï¼‰çš„æ ¸å¿ƒæ¡æ–‡ã€‚qa_reviewer åœ¨å®¡æŸ¥æŠ€æœ¯æ–¹æ¡ˆæ—¶å¿…é¡»è°ƒç”¨æ­¤å·¥å…·è·å–å‡†ç¡®æ¡æ–‡ä¾æ®ï¼Œä¸¥ç¦å‡­è®°å¿†å¼•ç”¨ã€‚",
  args: {
    keywords: tool.schema
      .array(tool.schema.string())
      .min(1)
      .describe("æŸ¥è¯¢å…³é”®è¯åˆ—è¡¨ï¼Œå¦‚ [\"æŠ¥è­¦å€¼\", \"åŸºå‘\"] æˆ– [\"æ°´å‡†\", \"é—­åˆå·®\"]"),
    standardCode: tool.schema
      .enum(["GB 50911", "GB 50497", "JGJ 8", "GB 50026", "all"])
      .default("all")
      .describe("é™å®šæŸ¥è¯¢çš„è§„èŒƒç¼–å·ï¼Œé»˜è®¤æœç´¢å…¨éƒ¨"),
    mandatoryOnly: tool.schema
      .boolean()
      .default(false)
      .describe("æ˜¯å¦åªè¿”å›å¼ºåˆ¶æ€§æ¡æ–‡"),
  },
  async execute(args) {
    let pool = STANDARDS
    if (args.standardCode !== "all")
      pool = pool.filter(c => c.code === args.standardCode)
    if (args.mandatoryOnly)
      pool = pool.filter(c => c.mandatory)

    const scored = pool
      .map(c => ({ clause: c, score: score(c, args.keywords) }))
      .filter(r => r.score > 0)
      .sort((a, b) => b.score - a.score)

    if (scored.length === 0)
      return JSON.stringify({
        query: args.keywords,
        results: [],
        message: `æœªæ‰¾åˆ°ä¸å…³é”®è¯ [${args.keywords.join(", ")}] åŒ¹é…çš„æ¡æ–‡ã€‚å»ºè®®è°ƒæ•´å…³é”®è¯æˆ–æ‰©å¤§æœç´¢èŒƒå›´ã€‚`,
      })

    const results = scored.slice(0, 8).map(r => ({
      code: r.clause.code,
      title: r.clause.title,
      section: r.clause.section,
      content: r.clause.content,
      mandatory: r.clause.mandatory,
      relevance: r.score,
    }))

    return JSON.stringify({
      query: args.keywords,
      standard_filter: args.standardCode,
      mandatory_only: args.mandatoryOnly,
      total_matches: scored.length,
      returned: results.length,
      results,
      message: `âœ… å…±æ‰¾åˆ° ${scored.length} æ¡ç›¸å…³æ¡æ–‡ï¼Œè¿”å›å‰ ${results.length} æ¡ï¼ˆæŒ‰ç›¸å…³åº¦æ’åºï¼‰ã€‚`,
    })
  },
})

export const list_standards = tool({
  description:
    "åˆ—å‡ºå†…ç½®è§„èŒƒåº“ä¸­æ‰€æœ‰å¯æŸ¥è¯¢çš„è§„èŒƒæ¸…å•åŠæ¡æ–‡æ•°é‡ï¼Œä¾› qa_reviewer äº†è§£å½“å‰çŸ¥è¯†åº“è¦†ç›–èŒƒå›´ã€‚",
  args: {},
  async execute() {
    const summary = new Map<string, { title: string; total: number; mandatory: number }>()
    for (const c of STANDARDS) {
      const existing = summary.get(c.code) ?? { title: c.title, total: 0, mandatory: 0 }
      existing.total++
      if (c.mandatory) existing.mandatory++
      summary.set(c.code, existing)
    }

    const list = [...summary.entries()].map(([code, info]) => ({
      code,
      title: info.title,
      total_clauses: info.total,
      mandatory_clauses: info.mandatory,
    }))

    return JSON.stringify({
      standards: list,
      total_clauses: STANDARDS.length,
      message: `ğŸ“š è§„èŒƒåº“å…±æ”¶å½• ${summary.size} éƒ¨è§„èŒƒã€${STANDARDS.length} æ¡æ ¸å¿ƒæ¡æ–‡ã€‚`,
    })
  },
})
