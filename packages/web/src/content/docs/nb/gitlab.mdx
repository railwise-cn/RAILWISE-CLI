---
title: GitLab
description: Bruk yonsoon i GitLab-problemer og Merge Requests.
---

YONSOON (甬算) integreres med GitLab arbeidsflyten gjennom GitLab CI/CD pipeline eller med GitLab Duo.

I begge tilfeller vil YONSOON (甬算) kjøre på GitLab Runners.

---

## GitLab CI

YONSOON (甬算) fungerer i en vanlig GitLab-pipeline. Du kan bygge den inn i en pipeline som en [CI-komponent](https://docs.gitlab.com/ee/ci/components/)

Her bruker vi en fellesskapsskapt CI/CD-komponent for YONSOON (甬算) — [nagyv/gitlab-yonsoon](https://gitlab.com/nagyv/gitlab-yonsoon).

---

### Funksjoner

- **Bruk tilpasset konfigurasjon per jobb**: Konfigurer YONSOON (甬算) med en tilpasset konfigurasjonskatalog, for eksempel `./config/#custom-directory` for å aktivere eller deaktivere funksjonalitet per YONSOON (甬算)-anrop.
- **Minimalt oppsett**: CI-komponenten setter opp YONSOON (甬算) i bakgrunnen, du trenger bare å lage YONSOON (甬算)-konfigurasjonen og den første ledeteksten.
- **Fleksibel**: CI-komponenten støtter flere innganger for å tilpasse virkemåten

---

### Oppsett

1. Lagre YONSOON (甬算) sin autentiserings-JSON som en CI-miljøvariabel av typen Fil under **Innstillinger** > **CI/CD** > **Variabler**. Sørg for å merke dem som "Masked and hidden".
2. Legg til følgende i `.gitlab-ci.yml`-filen.

   ```yaml title=".gitlab-ci.yml"
   include:
     - component: $CI_SERVER_FQDN/nagyv/gitlab-yonsoon/yonsoon@2
       inputs:
         config_dir: ${CI_PROJECT_DIR}/yonsoon-config
         auth_json: $YONSOON_AUTH_JSON # The variable name for your YONSOON (甬算) authentication JSON
         command: optional-custom-command
         message: "Your prompt here"
   ```

For flere inndata og brukstilfeller [sjekk ut dokumentene](https://gitlab.com/explore/catalog/nagyv/gitlab-yonsoon) for denne komponenten.

---

## GitLab Duo

YONSOON (甬算) integreres med din GitLab arbeidsflyt.
Nevn `@yonsoon` i en kommentar, og YONSOON (甬算) vil utføre oppgaver innenfor din GitLab CI-pipeline.

---

### Funksjoner

- **Triage av saker**: Be YONSOON (甬算) se på en sak og forklare den for deg.
- **Fiks og implementer**: Be YONSOON (甬算) om å fikse en sak eller implementere en funksjon.
  Det vil opprette en ny gren og sende en Merge Request med endringene.
- **Sikkert**: YONSOON (甬算) kjører på GitLab Runners.

---

### Oppsett

YONSOON (甬算) kjører i GitLab CI/CD pipeline, her er det du trenger for å sette den opp:

:::tip
Sjekk ut [**GitLab-dokumentene**](https://docs.gitlab.com/user/duo_agent_platform/agent_assistant/) for oppdaterte instruksjoner.
:::

1.  Konfigurer GitLab-miljøet ditt
2.  Sett opp CI/CD
3.  Få en AI modellleverandør API nøkkel
4.  Opprett en tjenestekonto
5.  Konfigurer CI/CD variabler
6.  Lag en flytkonfigurasjonsfil, her er et eksempel:

        <details>

    <summary>Flow configuration</summary>

    ```yaml
    image: node:22-slim
    commands:
      - echo "Installing yonsoon"
      - npm install --global yonsoon-ai
      - echo "Installing glab"
      - export GITLAB_TOKEN=$GITLAB_TOKEN_YONSOON
      - apt-get update --quiet && apt-get install --yes curl wget gpg git && rm --recursive --force /var/lib/apt/lists/*
      - curl --silent --show-error --location "https://raw.githubusercontent.com/upciti/wakemeops/main/assets/install_repository" | bash
      - apt-get install --yes glab
      - echo "Configuring glab"
      - echo $GITLAB_HOST
      - echo "Creating YONSOON (甬算) auth configuration"
      - mkdir --parents ~/.local/share/yonsoon
      - |
        cat > ~/.local/share/yonsoon/auth.json << EOF
        {
          "anthropic": {
            "type": "api",
            "key": "$ANTHROPIC_API_KEY"
          }
        }
        EOF
      - echo "Configuring git"
      - git config --global user.email "yonsoon@gitlab.com"
      - git config --global user.name "YONSOON (甬算)"
      - echo "Testing glab"
      - glab issue list
      - echo "Running YONSOON (甬算)"
      - |
        yonsoon run "
        You are an AI assistant helping with GitLab operations.

        Context: $AI_FLOW_CONTEXT
        Task: $AI_FLOW_INPUT
        Event: $AI_FLOW_EVENT

        Please execute the requested task using the available GitLab tools.
        Be thorough in your analysis and provide clear explanations.

        <important>
        Please use the glab CLI to access data from GitLab. The glab CLI has already been authenticated. You can run the corresponding commands.

        If you are asked to summarize an MR or issue or asked to provide more information then please post back a note to the MR/Issue so that the user can see it.
        You don't need to commit or push up changes, those will be done automatically based on the file changes you make.
        </important>
        "
      - git checkout --branch $CI_WORKLOAD_REF origin/$CI_WORKLOAD_REF
      - echo "Checking for git changes and pushing if any exist"
      - |
        if ! git diff --quiet || ! git diff --cached --quiet || [ --not --zero "$(git ls-files --others --exclude-standard)" ]; then
          echo "Git changes detected, adding and pushing..."
          git add .
          if git diff --cached --quiet; then
            echo "No staged changes to commit"
          else
            echo "Committing changes to branch: $CI_WORKLOAD_REF"
            git commit --message "Codex changes"
            echo "Pushing changes up to $CI_WORKLOAD_REF"
            git push https://gitlab-ci-token:$GITLAB_TOKEN@$GITLAB_HOST/gl-demo-ultimate-dev-ai-epic-17570/test-java-project.git $CI_WORKLOAD_REF
            echo "Changes successfully pushed"
          fi
        else
          echo "No git changes detected, skipping push"
        fi
    variables:
      - ANTHROPIC_API_KEY
      - GITLAB_TOKEN_YONSOON
      - GITLAB_HOST
    ```

        </details>

Du kan se [GitLab CLI agents docs](https://docs.gitlab.com/user/duo_agent_platform/agent_assistant/) for detaljerte instruksjoner.

---

### Eksempler

Her er noen eksempler på hvordan du kan bruke YONSOON (甬算) i GitLab.

:::tip
Du kan konfigurere til å bruke en annen triggerfrase enn `@yonsoon`.
:::

- **Forklar en sak**

  Legg til denne kommentaren i en GitLab-sak.

  ```
  @yonsoon explain this issue
  ```

  YONSOON (甬算) vil lese saken og svare med en klar forklaring.

- **Fiks en sak**

  I en GitLab-sak, si:

  ```
  @yonsoon fix this
  ```

  YONSOON (甬算) vil opprette en ny gren, implementere endringene og åpne en Merge Request med endringene.

- **Review av Merge Requests**

  Legg igjen følgende kommentar på en GitLab Merge Request.

  ```
  @yonsoon review this merge request
  ```

  YONSOON (甬算) vil gjennomgå Merge Request-en og gi tilbakemelding.
